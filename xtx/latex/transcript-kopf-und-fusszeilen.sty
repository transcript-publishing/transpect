\def\ps@empty{%
  \let\@oddhead\@empty
  \let\@oddfoot\@empty
  \let\@evenhead\@empty
  \let\@evenfoot\@empty
}
\newif\ifhasparts \haspartsfalse

\def\ps@headings{%
  \def\left@side{\ifx\partmarkoverride\@undefined\ifcollection\ifx\authormark\@empty\leftmark\else\authormark\fi\else\ifhasparts\partmark\else\@title\fi\fi\else\partmarkoverride\fi}%
  \def\@oddhead{\hfill{\small\sffamily\leftmark\rlap{\hb@xt@8mm{\hfill\thepage}}%
      % \ifx\lay b\relax\llap{\smash{\lower1.35mm\hb@xt@\textwidth{\rule{\textwidth}{.4\p@}}}}\fi
    }}%
  \def\@evenhead{%
    % \ifx\lay b\relax\rlap{\smash{\lower1.35mm\hb@xt@\textwidth{\rule{\textwidth}{.4\p@}}}}\fi
    {\small\sffamily\llap{\hb@xt@8mm{\thepage\hfill}}\left@side}\hfill}%
  \let\@oddfoot\@empty
  \let\@evenfoot\@empty
    \def\chaptermark##1{%
  \ifcollection
    \markboth {##1}{}%
  \else
    \ifnum \c@secnumdepth >\m@ne
      \markboth {\thechapter\enskip##1}{}%
    \else
      \markboth {##1}{}%
    \fi
  \fi%
  }%
}
\pagestyle{headings}