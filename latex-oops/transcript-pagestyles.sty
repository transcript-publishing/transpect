\NeedsTeXFormat{LaTeX2e}[2018/12/01]
\ProvidesPackage{transcript-pagestyles}[2021/04/09 transcript]\relax

\def\ps@empty{%
  \let\@oddhead\@empty
  \let\@oddfoot\@empty
  \let\@evenhead\@empty
  \let\@evenfoot\@empty
}

\def\ps@headings{%
  \def\left@mark{%
    \def\numberline####1{####1\enskip}%
    \ifx\@chaptername\contentsname\else
      \ifx\has@parts\relax
        \ifx\@partmark\@undefined
          \tpRunBookTitle
        \else
          \ifx\@chaptermark\@undefined
            \tpRunBookTitle
          \else
            \@partmark
          \fi
        \fi
      \else
        \ifcollection
          \@authormark
        \else
          \tpRunBookTitle
        \fi
      \fi
    \fi
  }%
  \def\right@mark{%
    \def\numberline####1{####1\enskip}%
    \ifx\@chaptername\contentsname\else
      \ifx\has@parts\relax
        \ifcollection
          \ifx\@authormark\@empty
          \else
            \@authormark:\space%
          \fi
        \fi
        \ifx\@partmark\@undefined
          \ifx\@chaptermark\@undefined
            \tpRunBookTitle%
          \else
            \@chaptermark%
          \fi
        \else
          \ifx\@chaptermark\@undefined
            \@partmark%
          \else
            \@chaptermark%
          \fi
        \fi
      \else
        \ifx\@chaptermark\@undefined
          \tpRunBookTitle%
        \else
          \@chaptermark%
        \fi
      \fi
    \fi
  }%
  \def\@oddhead{\hfill{\small\sffamily\right@mark\rlap{\hb@xt@8mm{\hfill\thepage}}%
      % \ifx\lay b\relax\llap{\smash{\lower1.35mm\hb@xt@\textwidth{\rule{\textwidth}{.4\p@}}}}\fi
    }}%
  \def\@evenhead{%
    % \ifx\lay b\relax\rlap{\smash{\lower1.35mm\hb@xt@\textwidth{\rule{\textwidth}{.4\p@}}}}\fi
    {\small\sffamily\llap{\hb@xt@8mm{\thepage\hfill}}\left@mark}\hfill}%
  \let\@oddfoot\@empty
  \let\@evenfoot\@empty
  \def\partmark##1{%
    \protected@xdef\@partmark{##1}%
  }%
  \def\chaptermark##1{%
    \protected@xdef\@chaptermark{##1}%
  }%
}


\def\ps@backmatter{% Ticket 14571.
  \def\left@mark{%
    \def\numberline####1{####1\enskip}%
    \tp@runningHeadingLeft@backmatter%
  }%
  \def\right@mark{%
    \def\numberline####1{####1\enskip}%
    \tp@runningHeadingRight@backmatter%
  }%
  \def\@oddhead{\hfill{\small\sffamily\right@mark\rlap{\hb@xt@8mm{\hfill\thepage}}%
      % \ifx\lay b\relax\llap{\smash{\lower1.35mm\hb@xt@\textwidth{\rule{\textwidth}{.4\p@}}}}\fi
    }}%
  \def\@evenhead{%
    % \ifx\lay b\relax\rlap{\smash{\lower1.35mm\hb@xt@\textwidth{\rule{\textwidth}{.4\p@}}}}\fi
    {\small\sffamily\llap{\hb@xt@8mm{\thepage\hfill}}\left@mark}\hfill}%
  \let\@oddfoot\@empty
  \let\@evenfoot\@empty
  \def\partmark##1{%
    \protected@xdef\@partmark{##1}%
  }%
  \def\chaptermark##1{%
    \protected@xdef\@chaptermark{##1}%
  }%
}


\def\ps@articlehead{%
  \ps@headings
  \def\@oddhead{\smash{\vtop{\hfill\footnotesize\nsffamily\tpNamespace{titlepage}\tpUseComp{JournalName}\space\tpUseComp{Year}\enskip\tpUseComp{Volume}/\tpUseComp{Issue}\ifx\@articleLicenceLogo\relax\else\enskip\includegraphics[height=7bp]{\@articleLicenceLogo}\fi\@@par\hfill \@articleDOI}}}%
  \def\@oddfoot{\smash{\parskip\z@\parindent\z@\vbox{\box\@articlefooterbox}}}
}

\pagestyle{headings}
