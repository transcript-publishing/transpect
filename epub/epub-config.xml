<?xml version="1.0" encoding="UTF-8"?>   
<?xml-model href="http://transpect.io/epubtools/schema/metadata-conf/metadata-conf.rng" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="http://transpect.io/epubtools/schema/metadata-conf/metadata-conf.rng" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<epub-config xmlns:tr="http://transpect.io" 
  format="EPUB3" 
  layout="reflowable" 
  css-handling="regenerated-per-split remove-comments"
  html-subdir-name="content"
  indent="selective">
	<!-- layout: reflowable|fixed
	       (default: reflowable; fixed only permitted for KF8 and EPUB3 layouts)
	     format: EPUB2|EPUB3|KF8 (default: EPUB3)
  	     Please note that specifying the format as the target option will override conf settings. 
	     css-handling: regenerated-per-split|regenerated-per-split remove-comments|unchanged (default: regenerated-per-split)
	       Note: 'regenerated-per-split remove-comments' is the same as 'remove-comments regenerated-per-split' 
	-->
	
	<!-- COVER:
		Unless there is a div with id='epub-cover-image-container'
		or with epub:type='cover', cover HTML (or SVG wrapper, if svg='true') 
		code will be generated.
		The href attribute should include the path to the cover image file
		(currently: PNG or JPEG). 
		It may be an http(s):, a file:, or a relative URI. Relative
		URIs will be resolved against the HTML source location.
	  Support for external SVG files yet to be implemented.-->
  <cover href="http://this.transpect.io/a9s/common/epub/fallback-cover.png" svg="true"/>
	
	<types>
    <!-- A mapping from epub:type attribute values to generated
      headings or list entries (type/@heading attribute) or export
      file base names (type/@file) for the typed items. -->
    <!-- A toc will be generated unless there is already a nav[@epub:type='toc'].
    You can control its appearance in the spine content with the hidden attribute.
    If there is already a toc in the content, hidden is always interpreted as 'false'.
    Is that what you want? Our thinking was along the lines: if you include a rendered
    toc in your HTML, you want to show it to the world. 
    
    Please note that due to limitations of Relax NG (or of the schema designer),
    the required order of type declarations is toc, landmarks, everything else.
    -->
	  <type name="toc" generate-heading="yes" hidden="true"/>
	  <!--
      There may be an optional hidden attribute for landmarks and toc (values: true|false,
      default: true). It applies only to generated nav elements.
      Please note that some reading systems still ignore this setting.
      The generated landmarks nav element has the id 'landmarks'. 
      If the toc is visible and you want to suppress the display of the landmarks nav,
      add nav#landmarks { display: none } to your CSS.
      The types attribute is optional. You may use it to restrict the landmarks to certain 
      types. By default, all types defined as landmark-types in the associated RNG schema
      will be considered when generating the landmarks. 
	    fallback-id-for-landmark: See the embedded documentation in the Relax NG schema. 
	  --> 
    <type name="landmarks" generate-heading="yes" types="cover titlepage toc epigraph loi lot imprint copyright-page"/>
    <type name="cover" heading="Cover" file="cover" guide-type="text"/>
    <type name="frontmatter" heading="Vorspann"/>
    <type name="bodymatter" heading="Hauptteil"/>
    <type name="backmatter" heading="Anhang"/>
    <type name="glossary" heading="Glossar"/>
    <type name="tr:bio" file="author"/>
    <type name="contributors" file="author" heading="Über die Autoren"/>
    <type name="tr:about-the-book" file="about-the-book"/>
    <type name="preamble" generate-heading="yes" heading="Über das Buch" file="about-the-book"/>
    <type name="titlepage" generate-heading="yes" heading="Titel" file="title"/>
    <type name="epigraph" generate-heading="yes" heading="Motto"/>
<!--    <type name="halftitlepage" file="halftitle" title="Frontmatter"/>-->
    <type name="abstract" file="about-the-content"/>
    <type name="fulltitle" file="title"/>
    <type name="imprint" generate-heading="yes" file="imprint" heading="Impressum"/>
    <type name="part" file="part"/>
    <type name="chapter" file="chapter"/>
    <type name="appendix" file="appendix"/>
    <type name="glossary" file="glossary"/>
    <type name="lot" file="lot" generate-heading="yes"/>
    <type name="loi" file="loi" generate-heading="yes"/>
    <type name="other-credits" file="other-credits"/>
    <type name="tr:popup" file="popup"/>
    <type name="tr:advertisement" file="advertisement"/>
  </types>

  <metadata xmlns:dc="http://purl.org/dc/elements/1.1/">
    <dc:identifier format="EPUB3"/>
    <dc:identifier format="KF8"/>
    <dc:title/>
    <dc:description/>
    <dc:creator/>
    <dc:publisher/>
    <dc:language/>
    <dc:rights/>
  </metadata>

  <hierarchy media-type="application/xhtml+xml" max-population="40" max-text-length="200000" generated-frontmatter-title="">
    <!-- see schema heading-conf.rng for generated-frontmatter-title -->
    <unconditional-split elt="div" attr="id" attval="epub-cover-image-container"/>
    <unconditional-split elt="section" attr="class" attval="halftitle"/>
    <unconditional-split elt="section" attr="epub:type" attval="titlepage"/>
    <unconditional-split elt="nav" attr="epub:type" attval="toc"/>
<!--    <unconditional-split elt="nav" attr="id" attval="landmarks-navigation"/>-->
    <unconditional-split elt="section" attr="class" attval="imprint"/>
    <unconditional-split elt="div" attr="class" attval="loi"/>
    <unconditional-split elt="div" attr="class" attval="lot"/>
    <unconditional-split elt="div" attr="class" attval="dedication"/>
    <unconditional-split elt="div" attr="class" attval="preface"/>
    <unconditional-split elt="div" attr="class" attval="part"/>
    <unconditional-split elt="div" attr="class" attval="chapter"/>
    <unconditional-split elt="div" attr="class" attval="notes"/>
<!--    <unconditional-split attr="epub:type" attval="cover"/>-->
    <unconditional-split attr="epub:type" attval="endnotes"/>
    <heading elt="h1"/>
    <heading elt="h2"/>
    <heading elt="h3"/>
    <heading elt="h4" level="4"/>
    <heading elt="h5" level="5"/>
    <heading elt="p" attr="class" attval="TOC1" level="1"/>
    <heading elt="p" attr="class" attval="TOC2" level="2"/>
    <heading elt="p" attr="class" attval="TOC3" level="3"/>
    <heading elt="p" attr="class" attval="TOC4" level="4"/>
    <heading elt="p" attr="class" attval="TOC5" level="5"/>
  </hierarchy>
  
  <checks>
    <!-- 1 kB = 1024 Bytes, 1 MB = 1024 kB -->
    <check param="result-max-mb" value="12" severity="warning"/>
    <!-- result-max-mb: Max total EPUB file size --> 
    <check param="result-max-mb" value="500" severity="error"/>
    
    <check param="html-max-kb" value="300" severity="warning"/>
    
    <check param="image-max-mb" value="1.5" severity="warning"/>
    
    <!-- 1 Mpx = 1e6 px -->
    <check param="image-max-mpx" value="3.2" severity="warning"/>
    
    <!-- image-dpi: Will require all images that have density information to report this as XXXdpi,
    otherwise unchecked. Desirable: calculation depending on CSS settings, typical screen sizes, pixel count. -->
    <check param="image-min-dpi" value="300" severity="warning"/>
    <check param="image-max-dpi" value="300" severity="warning"/>
    
    <!-- all combinations of min/max, height/width, error/warning are supported: -->
    <check param="image-max-height" value="750" severity="warning"/>
    
    <check param="cover-min-width-px" value="800" severity="warning"/>
    <check param="cover-max-width-px" value="1440" severity="warning"/>
    <!-- Custom Schematron. See the debug-dir/epubtools/input-for-schematron.xml (after running 
      a conversion with debug=yes) for an input example. See the included Schematron file
      schematron/epub.sch.xml for rule examples. -->
<!--    <schematron uri="http://some.location/schematron.sch"/>-->
  </checks>
</epub-config>
